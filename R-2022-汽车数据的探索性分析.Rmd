---
title: "test-2022-"
author: "Siyi Li"
date: "15/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
a<-list(1,2,3,4,5,"Siyi")
a[[4]]
```


```{r}
b<-c(1,2,3,4,5,"Siyi")
b
```

```{r}
library(ggplot2)
diamonds
```


```{r}
names(diamonds)
```

```{r}
library(MASS)
Cars93
```


```{r}
str(Cars93)
```
```{r}
summary(Cars93)
```

```{r}
library(Hmisc)
describe(Cars93)
```

```{r}
n_cars<-Cars93[,c
               (5,7,8)]
n_cars
```
```{r}
apply(n_cars, 2, mean)
apply(n_cars, 2, sd)

library(e1071)
apply(n_cars, 2, skewness)

mean(n_cars$Price)
sd(n_cars$Price)
skewness(n_cars$Price)
```

```{r}
library(ggplot2)
```

```{r}
ggplot(n_cars,
       aes(x=Price))+
  geom_boxplot()
```


```{r}
ggplot(n_cars,
       aes(x=Price, y=MPG.city))+
  geom_point()+
  geom_smooth()
```
```{r}
ggplot(n_cars,
       aes(x=Price))+
  geom_density(fill="blue")
```


```{r}
library(GGally)
ggpairs(n_cars)
```

```{r}
pairs(n_cars,main="correlation plot", col="blue", panel = points)
```


```{r}
# Normal distribution
pnorm(35, mean = mean(Cars93$MPG.highway), sd = sd(Cars93$MPG.highway), lower.tail = TRUE, log.p = FALSE)

#ä¸€è¾†æ–°è½¦æ¯åŠ ä»‘åˆè¡Œé©¶53åƒç±³çš„æ¦‚ç‡

```

```{r}
pnorm(35, mean = mean(Cars93$MPG.highway), sd = sd(Cars93$MPG.highway), lower.tail = F, log.p = FALSE)
```
```{r}
# Binomial Distribution
pbinom(1, 93, prob-0.1)

# ä¸€ä¸ªé›¶ä»¶åäº†çš„ æ¦‚ç‡ä¸º0.1 å‡è®¾æœ‰93 è¾†æ±½è½¦ï¼Œè‡³å°‘ä¸€è¾†åäº†é›¶ä»¶çš„è½¦è¢«æ£€æµ‹å‡ºæ¥çš„æ¦‚ç‡
```


```{r}
# Poisson Distribution
ppois(250, 200, lower.tail = F)

# å‡è®¾å¹³å‡æ¯åˆ†é’Ÿæœ‰200é¡¾å®¢è®¿é—®è¯¥ç½‘ç«™ï¼Œ ä¸€åˆ†é’Ÿå†…æœ‰250åé¡¾å®¢è®¿é—®è¯¥ç½‘ç«™çš„æ¦‚ç‡
```


```{r}
x<-fitdistr(Cars93$MPG.highway, densfun = "t")
x$estimate
x$sd
x$vcov  #the estimated variance-covariance matrix
x$loglik   #the log-likelihood
x$n
```


```{r}
y<-fitdistr(Cars93$MPG.highway, densfun = "normal")
y$estimate
y$sd
y$vcov  #the estimated variance-covariance matrix
y$loglik   #t
```

```{r}
qqnorm(Cars93$MPG.highway)
qqline(Cars93$MPG.highway)

```
```{r}
range(Cars93$Fuel.tank.capacity)
```

```{r}
cat<-c(9.2, 13.2,17.2,21.2,25.2)
```

```{r}
options(digits = 2)
t<-cut(Cars93$Fuel.tank.capacity, cat)
t
```


```{r}
as.data.frame(cbind(table(t)))
```

```{r}
table(Cars93$Type)
```

```{r}
table(Cars93$AirBags)
```

```{r}
contTable<-table(Cars93$Type, Cars93$AirBags)
contTable
```

```{r}
prop.table(contTable)
```

```{r}
prop.table(contTable, 1) #row percentage
```


```{r}
prop.table(contTable,2) # colomn percentage
```
```{r}
summary(contTable)
```
```{r}
contTable1<-table(Cars93$Type, Cars93$AirBags,Cars93$Origin)
contTable1
```

```{r}
summary(contTable1)
```

```{r}
library(nortest)
ad.test(Cars93$Price)
```

```{r}
cvm.test(Cars93$Price)
```

```{r}
lillie.test(Cars93$Price)
```

```{r}
pearson.test(Cars93$Price)
```

```{r}
sf.test(Cars93$Price) #p-vlue <0.05, so the variable is not a Nnormal Distribution
```


```{r}
library(corrplot)
o<-cor(Cars93[,c("Horsepower","Length")])
o
```
```{r}
corrplot(o)
corrplot(o, method="number", main="correlation plot")
corrplot(o, method="circle", main="correlation plot")
corrplot(o, method="ellipse", main="correlation plot")
```
```{r}
# å·²çŸ¥æ–¹å·®çš„å•ä¾§å‡å€¼æ£€éªŒ

mu<-mean(Cars93$MPG.highway)
mu
sigma<-sd(Cars93$MPG.highway)
sigma
n<-length(mean(Cars93$MPG.highway))
n
xbar=35
Z<-(xbar-mu)/(sigma/sqrt(n))
Z
alpha=0.05
Z1=qnorm(1-alpha)
Z1
ifelse(Z>Z1,"reject h0","accept h0")
```


```{r}
#å·²çŸ¥æ–¹å·®çš„åŒä¾§å‡å€¼æ£€éªŒ
Z2=qnorm(1-alpha/2)
Z2
c(-Z2, Z2)
ifelse(Z>Z2|Z<Z2,"reject h0","accept h0")
```




```{r}
mileage<-subset(Cars93, Cars93$RPM>5000)
mileage
```


```{r}
table(mileage$Origin)
```

```{r}
#å•æµ‹æ¯”ä¾‹æ£€éªŒ
p1<-17/57
p0<-0.4
n<-length(mileage)
n
z<-(p1-p0)/sqrt(p0*(1-p0)/n)
z

alpha=0.05
z1<-qnorm(1-alpha)
z1

ifelse(z>z1, "rejedt h0", "accept h0")
```

```{r}
#åŒä¾§æ¯”ä¾‹æ£€éªŒ
z2<-qnorm(1-alpha/2)
z2
c(-z2, z2)

ifelse(z>z2|z<z2, "rejedt h0", "accept h0")
```


```{r}
# æˆå¯¹æ£€éªŒ
# h0, æ— æ˜¾è‘—å·®å¼‚
# h1ï¼Œæœ‰æ˜¾è‘—å·®å¼‚

t.test(Cars93$Min.Price, Cars93$Max.Price, paired = T)
# p-value < 0.05, the difference between max price and the min price is significant
```


```{r}
#è¿›è¡Œtæ£€éªŒ2ğŸ’°ï¼Œ è¦æ£€æŸ¥æ•°æ®çš„æ­£æ€æ€§ï¼Œ ç”¨shapiroæ£€éªŒ
shapiro.test(Cars93$MPG.city)

qqnorm(Cars93$MPG.city)
qqline(Cars93$MPG.city)
#è¯¥å˜é‡ä¸æ˜¯æ­£æ€åˆ†å¸ƒï¼Œ æ‰€ä»¥è¦ç”¨éå‚æ•°æ–¹æ³•
```
```{r}
# æ— éå‚æ•°æ–¹æ³•

## Wilcoxon --- å½“æ­£æ€å‡è®¾ä¸æˆç«‹
wilcox.test(Cars93$MPG.city~Cars93$Man.trans.avail, correct=F)
# è‡ªåŠ¨æŒ¡å’Œæ‰‹åŠ¨æŒ¡æ±½è½¦çš„å¹³å‡è¡Œè½¦é‡Œç¨‹æ˜¯å¦æœ‰å·®åˆ«

# è‹¥ä¸¤ä¸ªæ ·æœ¬æ°å¥½æˆå¯¹ä½†åˆä¸æ»¡è¶³æ­£æ€å‡è®¾ åˆ™ä½¿ç”¨å‚æ•°paired
wilcox.test(Cars93$MPG.city, Cars93$MPG.highway, paired=T)




## Mann-Whitney-Wilcoxon --- ä¸¤ä¸ªæ ·æœ¬ä¸æˆå¯¹ï¼Œç‹¬ç«‹ä¸”ä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒ
wilcox.test(Cars93$MPG.city~Cars93$Man.trans.avail, data=Cars93)



## Kruskal-Wallis---æ¯”è¾ƒä¸¤ç»„ä»¥ä¸Šçš„å¹³å‡å€¼ï¼Œ æ— å‚æ–¹æ³•çš„æ–¹å·®åˆ†æï¼Œ æ— åˆ†å¸ƒçš„ç»Ÿè®¡æ£€éªŒ
kruskal.test(Cars93$MPG.city~Cars93$Cylinders, data=Cars93)

```




```{r}
#æ¯”è¾ƒåŒæ ·æœ¬æ–¹å·®ï¼Œ é‡‡ç”¨Fæ£€éªŒ
var.test(Cars93$MPG.highway~Cars93$Man.trans.avail, data=Cars93)
```
```{r}
# å•å› å­æ–¹å·®åˆ†æ
c<-aov(Cars93$RPM~Cars93$Cylinders)
c
summary(c)
# p-value<0.05, reject h0
# h0, ä¸åŒç¼¸æ•°çš„å¹³å‡RPMæ— å·®å¼‚
# h1ï¼Œè‡³å°‘ä¸€ç§ç¼¸æ•°çš„å¹³å‡RPMæœ‰å·®å¼‚



# äº‹åæ£€éªŒ ---ä¸ºäº†è¯†åˆ«å“ªä¸€ç§ç¼¸æ•°çš„å¹³å‡RPMå­˜åœ¨æ˜¾è‘—å·®å¼‚
TukeyHSD(c)

#p-adj<0.05ï¼Œ RPMçš„å¹³å‡å·®å¼‚æ˜¾è‘—æƒ³å°±æœ‰åˆ«äºå…¶ä»–åˆ†ç»„
```


```{r}
# åŒå› å­æ–¹å·®åˆ†æ
d<-aov(Cars93$RPM~Cars93$Origin+Cars93$AirBags)
d

summary(d)

TukeyHSD(d)
```



